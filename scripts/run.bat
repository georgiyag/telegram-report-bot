@echo off
chcp 65001 >nul
echo ========================================
echo   –ó–∞–ø—É—Å–∫ Telegram Report Bot
echo ========================================
echo.

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if not exist "venv\Scripts\activate.bat" (
    echo ‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    echo –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ scripts\setup_enhanced.bat
    pause
    exit /b 1
)

REM –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo [1/4] –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è...
call venv\Scripts\activate.bat
echo ‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
echo.
echo [2/4] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...
if not exist ".env" (
    echo ‚ùå –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω
    echo –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    pause
    exit /b 1
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
findstr /C:"TELEGRAM_BOT_TOKEN=your_bot_token_here" .env >nul
if not errorlevel 1 (
    echo ‚ùå –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω TELEGRAM_BOT_TOKEN –≤ —Ñ–∞–π–ª–µ .env
    echo –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —É @BotFather –∏ –æ–±–Ω–æ–≤–∏—Ç–µ .env
    pause
    exit /b 1
)

findstr /C:"GROUP_CHAT_ID=your_group_chat_id" .env >nul
if not errorlevel 1 (
    echo ‚ùå –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GROUP_CHAT_ID –≤ —Ñ–∞–π–ª–µ .env
    echo –£–∫–∞–∂–∏—Ç–µ ID –≤–∞—à–µ–π –≥—Ä—É–ø–ø—ã –≤ .env
    pause
    exit /b 1
)

echo ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo.
echo [3/4] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
python -c "import telegram, asyncio, aiofiles, aiosqlite" 2>nul
if errorlevel 1 (
    echo ‚ùå –ù–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
    echo –ó–∞–ø—É—Å—Ç–∏—Ç–µ scripts\setup_enhanced.bat –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    pause
    exit /b 1
)
echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

REM –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
if not exist "data" (
    mkdir data
    echo ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ data
)

REM –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
echo.
echo [4/4] –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞...
echo ========================================
echo   ü§ñ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...
echo   –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
echo ========================================
echo.

python src\main.py

echo.
echo ========================================
echo   –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
echo ========================================
pause